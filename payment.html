<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Payment</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

  <div style="padding:40px; font-family: Arial;">
    <h2>Payment Summary</h2>

    <p id="summary"></p>

    <button id="payNow">Pay Now</button>
  </div>

  <!-- Flutterwave -->
  <script src="https://checkout.flutterwave.com/v3.js"></script>

  <script>
    // ✅ READ BOOKING FROM SESSION STORAGE
    const booking = JSON.parse(sessionStorage.getItem("booking"));

    if (!booking) {
      alert("❌ No booking data found");
      window.location.href = "index.html";
    }

    const {
      name,
      email,
      apartment,
      nights,
      amount
    } = booking;

    // DISPLAY SUMMARY
    document.getElementById("summary").innerHTML = `
      <strong>Name:</strong> ${name}<br>
      <strong>Email:</strong> ${email}<br>
      <strong>Apartment:</strong> ${apartment}<br>
      <strong>Nights:</strong> ${nights}<br>
      <strong>Total:</strong> $${amount}
    `;

    // PAY NOW
    document.getElementById("payNow").onclick = function () {
      FlutterwaveCheckout({
        public_key: "FLWPUBK-eedd3e4e11cc685c3c851a3173222836-X",
        tx_ref: "tx_" + Date.now(),
        amount: amount,
        currency: "USD",
        customer: {
          email: email,
          name: name
        },
        callback: function (response) {
          if (response.status === "successful") {
            sessionStorage.removeItem("booking");
            window.location.href = "success.html";
          }
        }
      });
    };
  </script>

</body>
</html>
